//
//  input.h
//  earthnews
//
//  Created by Ubaka Onyechi on 16/12/2012.
//  Copyright (c) 2012 uonyechi.com. All rights reserved.
//

#ifndef EARTHNEWS_INPUT_H
#define EARTHNEWS_INPUT_H

////////////////////////////////////////////////////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////////////////////////////////////////////////

#include "../engine/cx_engine.h"

////////////////////////////////////////////////////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////////////////////////////////////////////////

typedef enum input_gesture_type
{
  INPUT_GESTURE_TYPE_INVALID = -1,
  INPUT_GESTURE_TYPE_PINCH,
  NUM_INPUT_GESTURE_TYPES,
} input_gesture_type;

typedef enum input_touch_type
{
  INPUT_TOUCH_TYPE_INVALID = -1,
  INPUT_TOUCH_TYPE_BEGIN,
  INPUT_TOUCH_TYPE_MOVE,
  INPUT_TOUCH_TYPE_END,
  NUM_INPUT_TOUCH_TYPES,
} input_touch_type;

////////////////////////////////////////////////////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////////////////////////////////////////////////

typedef struct input_touch_event
{
  input_touch_type type;
  cx_vec2 point;
  cx_vec2 prevpoint;
} input_touch_event;

typedef struct input_gesture_event
{
  input_gesture_type type;
  
  union input_gesture_event_data
  {
    struct input_gesture_pinch
    {
      float factor;
    } pinch;
    
  } data;
  
} input_gesture_event;

////////////////////////////////////////////////////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////////////////////////////////////////////////

typedef void (*input_touch_event_callback) (const input_touch_event *event);
typedef void (*input_gesture_event_callback) (const input_gesture_event *event);

////////////////////////////////////////////////////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////////////////////////////////////////////////

bool input_init (void);
bool input_deinit (void);
void input_update (void);

////////////////////////////////////////////////////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////////////////////////////////////////////////

void input_register_touch_event_callback (input_touch_type type, input_touch_event_callback fn);
void input_register_gesture_event_callback (input_gesture_type type, input_gesture_event_callback fn);

////////////////////////////////////////////////////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////////////////////////////////////////////////
// plugs into ios's view controller input
void _input_cache_touch_event (input_touch_type type, float x, float y, float px, float py);
void _input_cache_gesture_event (input_gesture_type type, void *gestureData);

////////////////////////////////////////////////////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////////////////////////////////////////////////

#endif
