//
//  feeds.h
//  earthnews
//
//  Created by Ubaka Onyechi on 14/07/2012.
//  Copyright (c) 2012 uonyechi.com. All rights reserved.
//

#ifndef EARTHNEWS_FEEDS_H
#define EARTHNEWS_FEEDS_H

#include <stdbool.h>
#include <time.h>

////////////////////////////////////////////////////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////////////////////////////////////////////////

typedef enum
{
  FEED_REQ_STATUS_INVALID,
  FEED_REQ_STATUS_IN_PROGRESS,
  FEED_REQ_STATUS_SUCCESS,
  FEED_REQ_STATUS_FAILURE,
} feed_req_status_t;

////////////////////////////////////////////////////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////////////////////////////////////////////////

typedef struct feed_news_item_t
{
  const char *title;
  const char *link;
  const char *date;
  struct feed_news_item_t *next;
} feed_news_item_t;

typedef struct feed_news_t
{
  feed_news_item_t *items;
  const char *link;
  time_t lastUpdate;
  bool dataPending;
  bool dataReady;
} feed_news_t;

////////////////////////////////////////////////////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////////////////////////////////////////////////

typedef struct feed_twitter_tweet_t
{
  const char *username;
  const char *userhandle;
  const char *text;
  const char *date;
  struct feed_twitter_tweet_t *next;
} feed_twitter_tweet_t;

typedef struct feed_twitter_t
{
  feed_twitter_tweet_t *items;
  unsigned int maxId;
  time_t lastUpdate;
  bool dataPending;
  bool dataReady;
} feed_twitter_t;

////////////////////////////////////////////////////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////////////////////////////////////////////////

typedef struct feed_weather_t
{
  const char *q;
  int celsius;
  int conditionCode;
  const char *date;
  char time [8];
  time_t lastUpdate;
  bool dataPending;
  bool dataReady;
  feed_req_status_t reqStatus;
} feed_weather_t;

////////////////////////////////////////////////////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////////////////////////////////////////////////

bool feeds_init (void);
bool feeds_deinit (void);

////////////////////////////////////////////////////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////////////////////////////////////////////////

void feeds_news_search (feed_news_t *feed, const char *query);

////////////////////////////////////////////////////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////////////////////////////////////////////////

void feeds_twitter_search (feed_twitter_t *feed, const char *query);

////////////////////////////////////////////////////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////////////////////////////////////////////////

bool feeds_weather_search (feed_weather_t *feed, const char *query);
bool feeds_weather_data_valid (const feed_weather_t *feed);
void feeds_weather_render (const feed_weather_t *feed, float x, float y, float z, float opacity);

////////////////////////////////////////////////////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////////////////////////////////////////////////

#endif
