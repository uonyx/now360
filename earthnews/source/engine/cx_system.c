//
//  cx_system.c
//
//  Created by Ubaka Onyechi on 14/01/2012.
//  Copyright (c) 2012 uonyechi.com. All rights reserved.
//

#include "cx_system.h"

////////////////////////////////////////////////////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////////////////////////////////////////////////

static bool s_initialised = false;

////////////////////////////////////////////////////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////////////////////////////////////////////////

static void cx_system_memory_init (void)    
{ 
#if CX_SYSTEM_CUSTOM_MEMORY_ALLOCATOR_ENABLED
  CX_FATAL_ERROR ("cx_system_memory_init: NOT YET IMPLEMENTED!");
#endif
}

////////////////////////////////////////////////////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////////////////////////////////////////////////

static void cx_system_memory_deinit (void)  
{ 
#if CX_SYSTEM_CUSTOM_MEMORY_ALLOCATOR_ENABLED
  CX_FATAL_ERROR ("cx_system_memory_deinit: NOT YET IMPLEMENTED!");
#endif
}

////////////////////////////////////////////////////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////////////////////////////////////////////////

void cx_system_init (void)
{
  cx_system_memory_init ();
  cx_system_time_start ();
  
  s_initialised = true;
}

////////////////////////////////////////////////////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////////////////////////////////////////////////

void cx_system_deinit (void)
{
  cx_system_memory_deinit ();
  
  s_initialised = false;
}

////////////////////////////////////////////////////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////////////////////////////////////////////////

void *_cx_malloc (size_t size)
{
  CX_ASSERT (s_initialised);
  return malloc (size);
}

////////////////////////////////////////////////////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////////////////////////////////////////////////

void _cx_free (void *data)
{
  CX_ASSERT (s_initialised);
  free (data);
}

////////////////////////////////////////////////////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////////////////////////////////////////////////